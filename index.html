<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>メインページ</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Google Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
  <style> body{font-family:'Noto Sans JP',sans-serif;} </style>

  <!-- Supabase Client & キー（置換済みならそのまま） -->
  <script type="module">
    import { createClient } from 'https://esm.sh/@supabase/supabase-js@2';
    window.supabase = createClient('__SUPABASE_URL__', '__SUPABASE_ANON__');
  </script>
</head>
<body class="min-h-screen bg-gradient-to-br from-indigo-50 to-cyan-100 flex flex-col items-center p-4">

  <!-- ── Header ─────────────────────────────── -->
  <header class="w-full max-w-4xl mb-10 flex items-center justify-between animate-fade-in">
    <div class="text-center flex-1">
      <h1 class="text-3xl md:text-4xl font-extrabold text-gray-800 drop-shadow-sm">
        メインページ
      </h1>
      <p class="mt-2 text-gray-500 text-base">遊技サポートツールへようこそ</p>
    </div>

    <!-- ▼ Login / Logout ボタン -->
    <button id="authBtn"
            class="whitespace-nowrap ml-4 px-4 py-2 rounded-lg bg-indigo-600 text-white font-semibold shadow-md
                   hover:bg-indigo-700 transition disabled:opacity-50">
      ログイン
    </button>
  </header>

  <!-- ── Main Links ─────────────────────────── -->
  <main class="w-full max-w-md space-y-6">
    <ul class="grid gap-6">
      <!-- 既存リンク（省略なし） -->
       <li>
          <a
            href="sim/index.html"
            class="group relative block rounded-2xl border border-gray-200 bg-white/70 backdrop-blur-lg p-6 shadow-lg transition-transform hover:-translate-y-1 hover:shadow-xl"
          >
            <span class="absolute -inset-1 rounded-2xl bg-gradient-to-r from-indigo-500 to-sky-500 opacity-0 transition-opacity group-hover:opacity-30"></span>
            <div class="relative z-10 flex items-center justify-between">
              <span class="text-lg font-semibold">シミュレーション</span>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="h-6 w-6 transition-transform group-hover:translate-x-1"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M8.25 4.5l7.5 7.5-7.5 7.5"
                />
              </svg>
            </div>
          </a>
        </li>
        <li>
          <a
            href="expect/machine.html"
            class="group relative block rounded-2xl border border-gray-200 bg-white/70 backdrop-blur-lg p-6 shadow-lg transition-transform hover:-translate-y-1 hover:shadow-xl"
          >
            <span class="absolute -inset-1 rounded-2xl bg-gradient-to-r from-indigo-500 to-sky-500 opacity-0 transition-opacity group-hover:opacity-30"></span>
            <div class="relative z-10 flex items-center justify-between">
              <span class="text-lg font-semibold">実戦データ入力</span>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="h-6 w-6 transition-transform group-hover:translate-x-1"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M8.25 4.5l7.5 7.5-7.5 7.5"
                />
              </svg>
            </div>
          </a>
        </li>
          <li>
          <a
            href="ledger/calendar.html"
            class="group relative block rounded-2xl border border-gray-200 bg-white/70 backdrop-blur-lg p-6 shadow-lg transition-transform hover:-translate-y-1 hover:shadow-xl"
          >
            <span class="absolute -inset-1 rounded-2xl bg-gradient-to-r from-indigo-500 to-sky-500 opacity-0 transition-opacity group-hover:opacity-30"></span>
            <div class="relative z-10 flex items-center justify-between">
              <span class="text-lg font-semibold">収支データ入力</span>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="h-6 w-6 transition-transform group-hover:translate-x-1"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M8.25 4.5l7.5 7.5-7.5 7.5"
                />
              </svg>
            </div>
          </a>
        </li>
          <li>
          <a
            href="ledger/stats.html"
            class="group relative block rounded-2xl border border-gray-200 bg-white/70 backdrop-blur-lg p-6 shadow-lg transition-transform hover:-translate-y-1 hover:shadow-xl"
          >
            <span class="absolute -inset-1 rounded-2xl bg-gradient-to-r from-indigo-500 to-sky-500 opacity-0 transition-opacity group-hover:opacity-30"></span>
            <div class="relative z-10 flex items-center justify-between">
              <span class="text-lg font-semibold">実践統計</span>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="h-6 w-6 transition-transform group-hover:translate-x-1"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M8.25 4.5l7.5 7.5-7.5 7.5"
                />
              </svg>
            </div>
          </a>
        </li>
    </ul>
  </main>

  <footer class="mt-12 text-sm text-gray-400">
    &copy; 2025 yuzo All rights reserved.
  </footer>

  <!-- ── Login / Logout ロジック ─────────────── -->
  <script type="module">
    import { supabase } from './assets/js/supabase-init.js';  // 既存の init を再利用

    const btn = document.getElementById('authBtn');

    /* 認証状態を取得してボタンを書き換え */
    const { data:{ user } } = await supabase.auth.getUser();
    updateBtn(!!user);

    /* ボタンクリック */
    btn.onclick = async () => {
      btn.disabled = true;

      if (btn.dataset.mode === 'login') {
        // ★ 例：メールMagicLinkに飛ばす場合
        location.href = 'login.html';
      } else {
        await supabase.auth.signOut();
        location.reload();
      }
    };

    function updateBtn(isLogin){
      if(isLogin){
        btn.textContent = 'ログアウト';
        btn.dataset.mode = 'logout';
      }else{
        btn.textContent = 'ログイン';
        btn.dataset.mode = 'login';
      }
    }
  </script>
</body>
</html>
